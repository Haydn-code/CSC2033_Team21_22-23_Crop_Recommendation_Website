<!DOCTYPE html>
<html>
<head>
	<title>Precision Agriculture - Interactive Map </title>
	<meta charset="utf-8">
	<meta name="viewport" content="initial-scale=1,maximum-scale=1,user-scalable=no">
	<link rel="stylesheet" href="../static/style.css">
	<link href="https://api.mapbox.com/mapbox-gl-js/v2.14.1/mapbox-gl.css" rel="stylesheet">
	<script src="https://api.mapbox.com/mapbox-gl-js/v2.14.1/mapbox-gl.js"></script>
</head>
<body>
    <section class="header">
        <div class="logo-container">
            <img src="../../Projectimg/logo5.png" alt="" class="logo">
        </div>
        <div class="navbar">
            <ul>
                <li><a href="../Homepage/index.html"">Home</a></li>
                <li class="active"><a href="../Mappage/map.html">Agriculture Map</a></li>
                <li><a href="../Cropinformationpage/crop-information.html">Crop Information</a></li>
                <li><a href="../users/login.html">Login</a></li>
            </ul>
        </div>
    </section>
    <section class="page-title-section">
    	<div class=img-container>
    		<img src="../../Projectimg/map-page.png" style="width: 100%">
    		<h1>Don't just plant, plant with purpose using our interactive map</h1>
    		<button onclick="scrollToSection()">Search the World to Find Your Optimum Conditions</button>
    	</div>
    </section>
	<section class="map">
		<div class="display-block">
			<div class="info-container">
				<div id="attribute-textbox">
					<h3>Name of Country:</h3>
					<h3>Name of Continent:</h3>
					<h3>Soil PH:</h3>
					<h3>Average Rainfall:</h3>
					<h3>Crops to be Grown:</h3>
				</div>
				<div id="info-textbox">
					<h3 id="country_name">France</h3>
					<h3 id="continent_name">Europe</h3>
					<h3>7.6</h3>
					<h3><5 mm per Annum</h3>
					<h3>- Grapes</h3>
					<h3>- Corn</h3>
					<h3>- Lavender</h3>
				</div>
			</div>
			<div class="map-container">
				<div id="map" style="height: 100%"></div>
			</div>
		</div>
	</section>
	<section class="donation">
		<div class="display-block">
			<div class="donation-container">
				<div id="img-container">
					<img src="../../Projectimg/zerohunger.jpg" style="height: 396px">
				</div>
				<div id="donate-textbox">
					<h1>Donate to Stop Hunger</h1>
					<p>Donating to the United Nations Zero Hunger sustainability goals 
					is a crucial step towards ending world hunger. Around 690 million 
					people in the world suffer from hunger, and achieving the goal of zero 
					hunger by 2030 requires collective action from individuals, 
					organisations, and governments. Donations to these goals are used to 
					provide essential resources such as food, clean water, and agricultural 
					training to those in need. The Zero Hunger sustainability goals also 
					address issues such as food waste, sustainable agriculture, and social 
					protection measures for vulnerable communities. By supporting these 
					goals, we can help create a world where everyone has access to the 
					food and resources they need to live a healthy and fulfilling life</p>
					<button><a href="../Donationpage/donations.html">Donate and Save Lives</a></button>
				</div>
			</div>
		</div>
	</section>
    <section class="footer">
        <p>&copy; 2023 Precision Agriculture. All Rights Reserved.</p>
    </section>
<script>
	function scrollToSection(){
		var element = document.querySelector('.map');
   		element.scrollIntoView({behavior: "smooth"});
	}

	mapboxgl.accessToken = 'pk.eyJ1IjoiYWxyb2JlcnRzb25leCIsImEiOiJjbGgyNjk0dWwxYW9kM2pqdXJwcDVyd25hIn0.C0kwA2ZQUzo1BJ0YzAbjIg';
    const map = new mapboxgl.Map({
        container: 'map',
        style: 'mapbox://styles/alrobertsonex/clh8y3kx600y601que40vfwe3',
        center: [0, 30],
        zoom: 1.75
    });
    let hoveredCountryId = null;

    map.on('load', () => {
        map.addSource('countries', {
            'type': 'vector',
            'url': 'mapbox://mapbox.country-boundaries-v1'
        });

        map.addLayer(
        	{
            'id': 'country_fills',
            'type': 'fill',
            'source': 'countries',
            'source-layer': 'country_boundaries',
            'layout': {},
            'paint': {
                'fill-color': '#447597',
                'fill-opacity': [
                    'case',
                    ['boolean', ['feature-state', 'hover'], false],
                    0.5,
                    0
                ]
            }
        });

        map.addLayer(
        	{
            'id': 'country_borders',
            'type': 'line',
            'source': 'countries',
            'source-layer': 'country_boundaries',
            'layout': {},
            'paint': {
                'line-color': '#2d648a',
                'line-width': 0.25
            }
        });

        map.on('mousemove', 'country_fills', (e) => {
            if (e.features.length > 0) {
                if (hoveredCountryId !== null) {
                    map.setFeatureState(
                        { source: 'countries',sourceLayer: 'country_boundaries', id: hoveredCountryId },
                        { hover: false }
                    );
                }
                hoveredCountryId = e.features[0].id;
                map.setFeatureState(
                    { source: 'countries',sourceLayer: 'country_boundaries', id: hoveredCountryId },
                    { hover: true }
                );
            }
        });

        map.on('mouseleave', 'country_fills', () => {
            if (hoveredCountryId !== null) {
                map.setFeatureState(
                    { source: 'countries',sourceLayer: 'country_boundaries', id: hoveredCountryId },
                    { hover: false }
                );
            }
            hoveredCountryId = null;
        });
        
        map.on('click', 'country_fills', (e) => {
            console.log(e.lngLat.wrap())
        	document.getElementById("country_name").innerHTML = e.features[0].properties["name_en"];
            document.getElementById("continent_name").innerHTML = e.features[0].properties["region"];
        });
    });
</script>
</body>
</html>
